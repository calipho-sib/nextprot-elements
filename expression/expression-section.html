<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../iron-icon/iron-icon.html">
<link rel="import" href="../../iron-icons/iron-icons.html">
<link rel="import" href="../../iron-collapse/iron-collapse.html">
<link rel="import" href="../../paper-spinner/paper-spinner-lite.html">
<link rel="import" href="../evidence-item.html">
<link rel="import" href="../quality-label.html">
<link rel="import" href="../external-scripts.html">
<link rel="import" href="../nextprot-elements-shared-styles.html">
<!--
`expression-section`
Annotation section used in function, medical, and expression views.

#### Example
    <generic-annotation-section section="function" categories='[ "GENERAL-ANNOTATION" ]'></generic-annotation-section>


@demo expression/demo/expression-section-demo.html
-->
<dom-module id="expression-section">
    <template>
        <style include="nextprot-elements-shared-styles">
           
        </style>
        <h1>BOUM</h1>
    </template>

    <script>
        Polymer({
            is: 'expression-section',
            properties: {
                nxConfig: {
                    type: Object,
                    value: {}
                },
                categories: {
                    type: Array,
                    value: []
                },
                categoryTitles: {
                    type: Object,
                    value: {}
                },
                annotationsByCategory: {
                    type: Array,
                    value: []
                },
                section: {
                    type: String
                },
                goldOnly: {
                    type: Boolean,
                    observer: "_getAnnotationsByView"
                },
                showEvidences: {
                    type: Boolean,
                    value: false
                },
                count: {
                    type: Number,
                    notify: true
                },
                isoform: {
                    type: String,
                    observer: "_reloadIsoform"
                }
            },
            ready: function(){
                //if(this.evidencesShown===undefined) this._toggleAllEvidences();
                Polymer.RenderStatus.afterNextRender(this, function() {
                    var nx = new Nextprot.Client("neXtprot expression section", "Calipho Group");
                    if (this.nxConfig.env) nx.updateEnvironment(this.nxConfig.env);
                    var apiCall = [];
                    apiCall.push(nx.getAnnotationsByCategory(this.nxConfig.entry, "expression"));

                    var self = this;
                    Promise.all(apiCall)
                            .then(function (categories) {
                                self.annotationsByCategory = categories;
                                console.log(categories);
                            }).catch(function (err) {
                                // catch any error that happened so far
                                console.log("Argh, broken: " + err.message);
                                console.log("Error at line : " + err.stack);
                                self.$.spinner.removeAttribute('active');
                                self.count = 0;
                            });
                });
            }
        });
    </script>
</dom-module>