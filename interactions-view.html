<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="protein-overview.html">
<link rel="import" href="isoform-selector.html">
<link rel="import" href="triple-viewer.html">
<link rel="import" href="generic-annotation-section.html">
<link rel="import" href="keywords-section.html">
<link rel="import" href="xrefs-section.html">
<link rel="import" href="nextprot-elements-shared-styles.html">
<!--
`interactions-view`
View listing protein interaction annotations.
@demo demo/interactions-view-demo.html
-->
<dom-module id="interactions-view">
  <template>
    <style include="nextprot-elements-shared-styles">
      :host {
        display: block;
        background:#ECF0F1;
        overflow-y: auto;
      }
    </style>
    <div class="row">
      <div id="nxOverview" class="col-md-12">
        <protein-overview nx-config="[[nxConfig]]" nx-entry="{{nxEntry}}"></protein-overview>
      </div>
    </div>
    <div id="nxPositionalAnnotations" class="row nxSection" hidden>
      <isoform-selector nx-config="[[nxConfig]]" iso-name={{isoName}}></isoform-selector>
      <triple-viewer nx-config="[[nxConfig]]" iso-name=[[isoName]] feature-list='[
      {
        "APIRef": "sequence",
        "metadata": {"name": "Sequence"}
      },
      {
        "APIRef": "interacting-region",
        "metadata": {
          "name": "Interacting region",
          "className": "intregion",
          "color": "#B3C2F0",
          "type": "rect",
          "filter": "Region"
        }
      },
      {
        "APIRef": "isoform-mapping",
        "metadata": {}
      }
    ]' count="{{positionalAnnotationsCount}}"></triple-viewer>
    </div>
    <div id="noDataWarning" class='alert alert-warning noData' hidden>There is no interaction information available in neXtProt for [[nxEntry]].
      Suggestions for updates are welcome! Please <a href='mailto:support@nextprot.org'>contact us</a>.
    </div>
    <div class="row">
      <div id="nxAnnotations" class="col-md-12">
        <generic-annotation-section section="interactions" goldOnly="[[goldOnly]]" nx-config="[[nxConfig]]" isoform="[[isoName]]"
                                    categories='["INTERACTION-INFO", "ENZYME-REGULATION", "COFACTOR", "BINARY-INTERACTION"]'
                                    category-titles='{"subunit": "overview", "BinaryInteraction": "Binary Interactions"}' count="{{annotationsCount}}">
        </generic-annotation-section>
        <!--filterAnnot:{annot-> (annot.getAnnotationCategory() == AnnotationCategory.MISCELLANEOUS &&
        !annot.getMiscellaneousSubCategory().equals('interaction'))? false:true;-->
      </div>
    </div>
    <div class="row">
      <div id="nxKeywords" class="col-md-12">
        <keywords-section categories='["Ligand"]' nx-config="[[nxConfig]]" count="{{keywordsCount}}">
        </keywords-section>
      </div>
    </div>
    <div class="row">
      <div id="nxXrefs" class="col-md-12">
        <xrefs-section categories='["BindingDB","DIP","IntAct","MINT","STRING","SignaLink","BioGrid"]' nx-config="[[nxConfig]]" count="{{xrefsCount}}">
        </xrefs-section>
      </div>
    </div>
  </template>

  <script>
    Polymer({
      is: 'interactions-view',
      properties: {
        nxConfig: {
          type: Object,
          value: {}
        },
        nxEntry: {
          type: String
        },
        isoName: {
          type: String
        },
        goldOnly: {
          type: Boolean,
          value: false
        },
        annotationsCount: {
          type: Number,
          observer: "_checkAnnotations"
        },
        positionalAnnotationsCount: {
          type: Number,
          observer: "_checkAnnotations"
        },
        keywordsCount: {
          type: Number,
          observer: "_checkKeywords"
        },
        xrefsCount: {
          type: Number,
          observer: "_checkXrefs"
        }
      },
      _checkAnnotations: function(){
        if(!this.annotationsCount && !this.positionalAnnotationsCount){
          this.$.noDataWarning.hidden=false;
        } else {
          this.$.noDataWarning.hidden=true;
        }
        if(!this.annotationsCount){
          this.$.nxAnnotations.hidden=true;
        } else {
          this.$.nxAnnotations.hidden=false;
        }
        if(!this.positionalAnnotationsCount){
          this.$.nxPositionalAnnotations.hidden=true;
        } else {
          this.$.nxPositionalAnnotations.hidden=false;
        }
      },
      _checkKeywords: function(){
        this.keywordsCount===0 ? this.$.nxKeywords.hidden=true : this.$.nxKeywords.hidden=false;
      },
      _checkXrefs: function(){
        this.xrefsCount===0 ? this.$.nxXrefs.hidden=true : this.$.nxXrefs.hidden=false;
      }
    });
  </script>
</dom-module>