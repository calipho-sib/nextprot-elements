<!DOCTYPE html>
<html>
<link rel="import" href="nextprot-elements-shared-styles.html">
<link rel="import" href="external-scripts.html">
<link rel="import" href="evidence-item.html">
<link rel="import" href="quality-label.html">
<link rel="import" href="heatmap-table-row.html">
<script src="../nextprot/src/nextprot-core.js"></script>
    <script src="../nextprot/src/nextprot-utils.js"></script>
<!-- <link rel="import" href="/nextprot-js/dataenzymes.html"> -->

<!-- <script src="../../jquery/dist/jquery.js"></script>
<script src="../../bootstrap/dist/js/bootstrap.js"></script> --> 

<!--
`digestion-overview`
Digestion overview
@demo demo/digestion-overview-demo.html
-->
<dom-module id="digestion-overview">

    <template>
        <!-- Latest compiled and minified CSS -->
        <template>
            <div class="enzymes"></div>
        </template>
    </template>

    <script>
        Polymer ({
            is: 'digestion-overview',
            properties: {
                nxConfig: {
                    type: Object,
                    value: {"env":"pro"},
                    observer: '_initAndLoadData' 
                },
                dataloaded: {
                    type: Boolean,
                    observer: 'updateSpinnerStatus'
                }
            },
        attached: function(){
            this._initAndLoadData();
        },
        _initAndLoadData: function(){
            if (this.nxConfig.env && !this.nxConfig.env.startsWith('{')){
                this._initApiClient();
                this._loadData();
            }
        },
        _initApiClient: function(){
            this._npClient = new NextProt.Client("demo","calipho");
            this._npClient.updateEnvironnement(this.nxConfig.env);
        },
        _loadData: function(){
            var x = this;
            if (this._npClient !== undefined){
                this._npClient.getJSON("/digestion/available-protease-list").then(function(data){
                    enzymes=[];
                    for (var enz in data){
                        enzymes.push(
                            [data[enz]
                            ]);
                    }
                });
            }
        },
        _dataloaded: function(){
            return this.enzymes 
        },
        _updateSpinnerStatus: function (){
            if (this._dataloaded()){
                this.$.spinner.active = false;
                this.$.spinner.hidden = true;
            }
        },
        _getJSON: function() {
            return this.enzymes;
        }
        });
    //   
        
    </script>
</dom-module>
</html>